<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thông tin tài khoản</title>
    <!--  jquery  -->
    <script src="/public/jquery-3.7.1.min.js"></script>
    <!--  bootstrap  -->
    <link rel="stylesheet" href="/public/bootstrap/css/bootstrap.css">
    <script src="/public/bootstrap/js/bootstrap.bundle.js"></script>
    <!--  css  -->
    <link rel="stylesheet" href="/layouts/layout.css">
    <link rel="stylesheet" href="/assets/css/main.css">
    <!--  js  -->
    <script src="/assets/js/loadVNAddress.js"></script>
</head>
<style>
    .hidden {
        display: none;
    }

    .nav.nav-pills .nav-link {
        color: gray;

        &.active {
            color: white;
            background-color: var(--custom-bg-primary);
        }
    }

    .eye-icon {
        width: 24px;
        height: 24px;
        cursor: pointer;
    }

    .tooltip-custom .tooltip-inner {
        background-color: #ffdddd; /* Màu nền nhạt hơn */
        color: #b30000; /* Màu chữ nổi bật */
        border: 1px solid #b30000; /* Khung viền đỏ */
        padding: 8px;
        font-weight: bold;
        border-radius: 5px;
    }

    .tooltip-custom .tooltip-arrow::before {
        border-top-color: #ffdddd; /* Màu nền mũi tên */
    }

</style>
<body class="p-0">
<div id="HEADER">
    <script>
        $("#HEADER").load("/includes/header.html");
    </script>
</div>
<div id="CONTENT" class="bg-secondary-subtle">
    <div class="container light-style py-5">
        <div class="row">
            <!-- left side -->
            <div class="col-3 me-3 bg-white shadow rounded-2 px-4" style="min-height: 40rem">
                <div class="row pt-3 pb-2 mb-3 border-bottom">
                    <div class="col-3 me-1">
                        <div class="text-bg-secondary rounded-circle ratio-1x1 ratio" style="width: 4rem;">
                            <div class="custom-icon" style="--size: 3rem">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                     class="bi bi-person" viewBox="0 0 16 16">
                                    <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                    <div class="col d-flex flex-column gap-1 justify-content-center">
                        <div class="fw-bold text-capitalize">Đặng Anh Kiệt</div>
                        <div class="text-muted">#anhkiet123</div>
                    </div>
                </div>
                <div>

                </div>
                <div class="nav nav-pills flex-column gap-3" id="v-pills-tab" role="tablist">
                    <div role="button" class="nav-link active" data-bs-toggle="pill" data-bs-target="#account-general">
                        <div class="custom-icon me-2 float-start" style="--size: 1.5rem">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-person" viewBox="0 0 16 16">
                                <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
                            </svg>
                        </div>
                        Tài khoản của tôi
                    </div>
                    <div role="button" class="nav-link" data-bs-toggle="pill" data-bs-target="#account-purchase-order">
                        <div class="custom-icon me-2 float-start" style="--size: 1.5rem">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-receipt" viewBox="0 0 16 16">
                                <path d="M1.92.506a.5.5 0 0 1 .434.14L3 1.293l.646-.647a.5.5 0 0 1 .708 0L5 1.293l.646-.647a.5.5 0 0 1 .708 0L7 1.293l.646-.647a.5.5 0 0 1 .708 0L9 1.293l.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .801.13l.5 1A.5.5 0 0 1 15 2v12a.5.5 0 0 1-.053.224l-.5 1a.5.5 0 0 1-.8.13L13 14.707l-.646.647a.5.5 0 0 1-.708 0L11 14.707l-.646.647a.5.5 0 0 1-.708 0L9 14.707l-.646.647a.5.5 0 0 1-.708 0L7 14.707l-.646.647a.5.5 0 0 1-.708 0L5 14.707l-.646.647a.5.5 0 0 1-.708 0L3 14.707l-.646.647a.5.5 0 0 1-.801-.13l-.5-1A.5.5 0 0 1 1 14V2a.5.5 0 0 1 .053-.224l.5-1a.5.5 0 0 1 .367-.27m.217 1.338L2 2.118v11.764l.137.274.51-.51a.5.5 0 0 1 .707 0l.646.647.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.509.509.137-.274V2.118l-.137-.274-.51.51a.5.5 0 0 1-.707 0L12 1.707l-.646.647a.5.5 0 0 1-.708 0L10 1.707l-.646.647a.5.5 0 0 1-.708 0L8 1.707l-.646.647a.5.5 0 0 1-.708 0L6 1.707l-.646.647a.5.5 0 0 1-.708 0L4 1.707l-.646.647a.5.5 0 0 1-.708 0z"/>
                                <path d="M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5m8-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5"/>
                            </svg>
                        </div>
                        Đơn mua
                    </div>
                    <!--                    <div role="button" class="nav-link" data-bs-toggle="pill" data-bs-target="#account-info">Thông Tin</div>-->
                    <div role="button" class="nav-link" data-bs-toggle="pill" data-bs-target="#account-address">
                        <div class="custom-icon me-2 float-start" style="--size: 1.5rem">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-geo-alt" viewBox="0 0 16 16">
                                <path d="M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10"/>
                                <path d="M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
                            </svg>
                        </div>
                        Địa Chỉ
                    </div>
                    <div role="button" class="nav-link" data-bs-toggle="pill" data-bs-target="#account-change-password">
                        <div class="custom-icon float-start me-2" style="--size: 1.5rem">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-key" viewBox="0 0 16 16">
                                <path d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"/>
                                <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
                            </svg>
                        </div>
                        Đổi Mật Khẩu
                    </div>
                    <div role="button" class="nav-link text-danger fw-semibold ">
                        <div class="custom-icon me-2 float-start" style="--size: 1.5rem">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-box-arrow-left" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                      d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0z"/>
                                <path fill-rule="evenodd"
                                      d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708z"/>
                            </svg>
                        </div>
                        Đăng xuất
                    </div>
                </div>
            </div>
            <!-- right side -->
            <div class="col bg-white rounded-2 shadow p-5">
                <div class="tab-content" id="v-pills-tabContent">
                    <div class="tab-pane fade active show" id="account-general">
                        <div>
                            <h4 class="fw-semibold">Quản lý thông tin cá nhân</h4>
                            <hr class="text-light">
                        </div>
                        <form class="d-flex flex-column gap-4">
                            <div class="row">
                                <label for="username" class="col-form-label col-sm-2 text-muted">Tên đăng nhập</label>
                                <div class="col-sm-10">
                                    <input type="text" readonly class="form-control-plaintext" id="username"
                                           value="anhkiet123">
                                </div>
                            </div>
                            <div class="row">
                                <label for="fullname" class="col-form-label col-sm-2 text-muted">Họ và tên</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" id="fullname" value="Đặng Anh Kiệt">
                                </div>
                            </div>
                            <div class="row">
                                <label for="email" class="col-form-label col-sm-2 text-muted">Email</label>
                                <div class="col-sm-10">
                                    <input type="text" readonly class="form-control-plaintext" id="email"
                                           value="anhkiet123@gmail.com">
                                </div>
                            </div>
                            <div class="row">
                                <label for="phone-number" class="col-form-label col-sm-2 text-muted">Số điện
                                    thoại</label>
                                <div class="col-sm-10">
                                    <input type="text" readonly class="form-control-plaintext" id="phone-number"
                                           value="0123 456 789">
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-form-label col-sm-2 text-muted">Giới tính </label>
                                <div class="col-sm-10">
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="gender" id="gender-male"
                                               checked>
                                        <label class="form-check-label" for="gender-male">Nam</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="gender" id="gender-female">
                                        <label class="form-check-label" for="gender-female">Nữ</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="gender" id="gender-other">
                                        <label class="form-check-label" for="gender-other">Khác </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <label for="birth-date" class="col-form-label col-sm-2 text-muted">Ngày sinh</label>
                                <div class="col-sm-10">
                                    <input type="date" class="form-control-plaintext" id="birth-date" value="2004-01-01"
                                           style="width: min-content;">
                                </div>
                            </div>
                            <button type="submit" class="btn custom-btn-primary px-4 py-2 ms-auto "
                                    style="width: max-content">Lưu thay đổi
                            </button>
                        </form>
                    </div>
                    <div class="tab-pane fade" id="account-change-password">
                        <div>
                            <h4 class="fw-semibold">Thay đổi mật khẩu </h4>
                            <hr class="text-light">
                        </div>
                        <form class="d-flex flex-column gap-4">
                            <div class="row">
                                <label for="current-password" class="col-form-label text-muted">Mật khẩu hiện
                                    tại</label>
                                <div class="col-12">
                                    <input type="password" class="form-control" id="current-password" value="password">
                                </div>
                            </div>
                            <div class="row">
                                <label for="new-password" class="col-form-label text-muted">
                                    Mật khẩu mới
                                    <span class="text-danger" data-bs-toggle="tooltip"
                                          data-bs-title="Mật khẩu mới phải chứa ít nhất 8 kí tự. Có ít nhất 1 kí tự in hoa và số"
                                          data-bs-placement="right">*</span>
                                </label>
                                <div class="col-12">
                                    <input type="password" class="form-control" id="new-password" value="">
                                </div>
                            </div>
                            <div class="row">
                                <label for="new-password-check" class="col-form-label text-muted">
                                    Nhập lại mật khẩu mới
                                    <span class="text-danger" data-bs-toggle="tooltip"
                                          data-bs-title="Mật khẩu phải khớp với mật khẩu mới" data-bs-placement="right">*</span>
                                </label>
                                <div class="col-12">
                                    <input type="password" class="form-control" id="new-password-check" value="">
                                </div>
                            </div>

                            <button type="submit" id="save-password-btn" class="btn btn-primary px-4 py-2 ms-auto "
                                    style="width: max-content">Lưu
                            </button>
                        </form>
                        <div class="modal fade" id="passwordChangeSuccessModal" tabindex="-1"
                             aria-labelledby="passwordChangeSuccessModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content p-2">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="passwordChangeSuccessModalLabel">Thông báo</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        Thay đổi mật khẩu thành công!
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Đóng
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="tab-pane fade active" id="account-address">
                        <div class="card-body pb-2">
                            <div class="form-group">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h4 class="fw-semibold">Địa chỉ của tôi</h4>
                                    <button type="button" class="btn btn-danger btn-sm mb-3" data-bs-toggle="modal"
                                            data-bs-target="#newAddressModal">+ Thêm địa chỉ mới
                                    </button>
                                </div>
                                <div style="height: 1px; background-color: #dbdbdb; width: 100%"></div>
                            </div>
                        </div>
                        <hr class="border-light m-0">
                        <div class="card-body pb-2">
                            <h6 class="mb-4">Địa Chỉ</h6>
                            <div id="addressList">
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" tabindex="-1" id="newAddressModal" data-bs-backdrop="static"
                         data-bs-keyboard="false">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content p-2">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="exampleModalLabel">Nhập địa chỉ mới</h1>
                                </div>
                                <div class="modal-body">
                                    <form action="" class="d-flex flex-column gap-3" id="newAddressForm">
                                        <div class="row">
                                            <div class="col-6 form-group">
                                                <input class="form-control" id="name" name="name"
                                                       placeholder="Nhập họ và tên" aria-label="">
                                            </div>
                                            <div class="col-6 form-group">
                                                <input type="text" class="form-control" id="phone" name="phone"
                                                       placeholder="Nhập số điện thoại" aria-label="">
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <input class="form-control" id="city" name="cityName" autocomplete="off"
                                                   list="cityList"
                                                   placeholder="Nhập tỉnh/thành phố" aria-label="">
                                            <datalist id="cityList"></datalist>
                                        </div>

                                        <div class="form-group">
                                            <input class="form-control" id="district" name="districtName"
                                                   autocomplete="off"
                                                   list="districtList"
                                                   placeholder="Nhập quận/huyện" aria-label="">
                                            <datalist id="districtList"></datalist>
                                        </div>

                                        <div class="form-group">
                                            <input type="text" class="form-control" id="ward" name="wardName"
                                                   autocomplete="off"
                                                   list="wardList"
                                                   placeholder="Nhập phường/xã" aria-label="">
                                            <datalist id="wardList"></datalist>
                                        </div>

                                        <div class="form-group">
                                            <input type="text" class="form-control" id="soNha" name="soNha"
                                                   autocomplete="off"
                                                   placeholder="Nhập địa chỉ cụ thể" aria-label="">
                                        </div>

                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-success" form="newAddressForm">
                                        Hoàn thành
                                    </button>
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                        Quay lại
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade hidden" id="editAddress">
                        <div class="card shadow p-3" style="width: 50rem; height: 100%">
                            <h5>Cập nhật địa chỉ</h5>
                            <form>
                                <div class="mb-3">
                                    <label for="editName" class="form-label">Họ và tên</label>
                                    <input type="text" class="form-control" id="editName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editPhone" class="form-label">SĐT</label>
                                    <input type="text" class="form-control" id="editPhone" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editCity" class="form-label">Tỉnh/Thành phố</label>
                                    <input type="text" class="form-control" id="editCity" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editDistrict" class="form-label">Quận/Huyện</label>
                                    <input type="text" class="form-control" id="editDistrict" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editWard" class="form-label">Phường/Xã</label>
                                    <input type="text" class="form-control" id="editWard" required>
                                </div>
                                <div class="form-group">
                                    <label for="editSoNha">Địa Chỉ</label>
                                    <input type="text" class="form-control" id="editSoNha"
                                           placeholder="Nhập Địa chỉ cụ thể" required>
                                </div>
                                <button type="button" class="btn btn-primary" onclick="saveUpdatedAddress()">Lưu
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="cancelEditAddress()">Hủy
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="FOOTER">
    <script>
        $("#FOOTER").load("/includes/footer.html");
    </script>
</div>
</body>
<script>
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));

    document.getElementById('save-password-btn').addEventListener('click', function (event) {
        const newPassword = document.getElementById('new-password');
        const newPasswordCheck = document.getElementById('new-password-check');

        // Kiểm tra độ dài mật khẩu mới, có ít nhất 1 kí tự in hoa và số
        const passwordRegex = /^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*])[A-Za-z\d!@#$%^&*]{8,}$/;
        let isValid = true;

        // Tạo tooltip tùy chỉnh cho mật khẩu mới
        if (!passwordRegex.test(newPassword.value)) {
            new bootstrap.Tooltip(newPassword, {
                title: 'Mật khẩu phải chứa ít nhất 8 kí tự, bao gồm chữ viết hoa, số và kí tự đặc biệt',
                placement: 'right',
                trigger: 'manual',
                customClass: 'tooltip-custom' // Thêm lớp tùy chỉnh
            }).show();
            isValid = false;
        }

        // Kiểm tra mật khẩu mới và mật khẩu nhập lại có khớp không
        if (newPassword.value !== newPasswordCheck.value) {
            new bootstrap.Tooltip(newPasswordCheck, {
                title: 'Mật khẩu nhập lại không khớp với mật khẩu mới',
                placement: 'right',
                trigger: 'manual',
                customClass: 'tooltip-custom' // Thêm lớp tùy chỉnh
            }).show();
            isValid = false;
        }

        if (!isValid) {
            event.preventDefault(); // Ngăn không cho gửi form nếu không hợp lệ
        } else {
            // Ẩn các tooltip khi hợp lệ
            bootstrap.Tooltip.getInstance(newPassword)?.hide();
            bootstrap.Tooltip.getInstance(newPasswordCheck)?.hide();

            // Hiển thị modal thành công
            const successModal = new bootstrap.Modal(document.getElementById('passwordChangeSuccessModal'));
            successModal.show();
        }

        // Ẩn tooltip khi người dùng bắt đầu chỉnh sửa lại
        newPassword.addEventListener('input', () => bootstrap.Tooltip.getInstance(newPassword)?.hide());
        newPasswordCheck.addEventListener('input', () => bootstrap.Tooltip.getInstance(newPasswordCheck)?.hide());
    });
</script>

</html>
