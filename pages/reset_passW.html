<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Đặt Lại Mật Khẩu</title>
    <!--  jquery  -->
    <script src="/public/jquery-3.7.1.min.js"></script>
    <!--  bootstrap  -->
    <link rel="stylesheet" href="/public/bootstrap/css/bootstrap.css">
    <script src="/public/bootstrap/js/bootstrap.bundle.js"></script>
    <!--  css  -->
    <link rel="stylesheet" href="/layouts/layout.css">
    <link rel="stylesheet" href="/assets/css/main.css">
    <!--  js  -->
    <style>
        .eye-icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }

        .tooltip-custom .tooltip-inner {
            background-color: white;
            color: black;
            border: 1px solid #339933;
            padding: 8px;
            font-weight: bold;
            border-radius: 5px;
        }

        .tooltip-custom .tooltip-arrow::before {
            /*border-top-color: black; !* Màu nền mũi tên *!*/
        }
    </style>
    <script>
        $(document).ready(function () {
            $("#FOOTER").load("/includes/footer.html");
        });
    </script>
<body>
<div id="page">
    <div class="container d-flex justify-content-center align-items-center gap-xxl-5"
         style="min-height: 38rem; min-width: 40rem">
        <div class="">
            <img src="https://www.crocodileinternational.com/img/crocodile-logo-1609222037.jpg"
                 style="width: 30rem; height: auto;"
                 alt="...">
        </div>
        <div class="card shadow-sm" style="height: 22rem; width: 25rem">
            <div class="card-body">
                <h3 class="card-title mb-3 text-center">Đặt Lại Mật Khẩu</h3>
                <div style="height: 2px; background-color: #dbdbdb; width: 100%;"></div>
                <p class="text-center mt-3">Vui lòng nhập mật khẩu mới của bạn.</p>
                <form id="resetPasswordForm" class="d-grid gap-lg-4">
                    <!-- Trường nhập mật khẩu mới -->
                    <div class="position-relative mb-3">
                        <input
                                class="form-control"
                                type="password"
                                id="password"
                                placeholder="Mật khẩu mới"
                                required
                                data-bs-toggle="tooltip"
                                data-bs-placement="top">
                        <span class="position-absolute top-50 end-0 translate-middle-y pe-3 eye-icon-container"
                              id="toggle-password"
                              onclick="togglePassword()">
        <svg id="eye-icon" class="eye-icon" viewBox="0 0 122.88 96.32">
            <path d="M104.54,23.28c6.82,6.28,12.8,14.02,17.67,22.87l0.67,1.22l-0.67,1.21c-6.88,12.49-15.96,22.77-26.48,29.86 c-8.84,5.95-18.69,9.67-29.15,10.59l6.73-11.66c5.25-1.42,10.24-3.76,14.89-6.9c8.18-5.51,15.29-13.45,20.79-23.1 c-2.98-5.22-6.43-9.94-10.26-14.05L104.54,23.28L104.54,23.28z M88.02,0l17.84,10.3L56.2,96.32l-17.83-10.3l0.69-1.2 c-4.13-1.69-8.11-3.83-11.9-6.38C16.62,71.35,7.55,61.07,0.67,48.59L0,47.37l0.67-1.22C7.55,33.67,16.62,23.39,27.15,16.3 C37.42,9.38,49.08,5.48,61.44,5.48c7.35,0,14.44,1.38,21.14,3.94L88.02,0L88.02,0L88.02,0z M44.36,75.63l5-8.67 c-5.94-3.78-9.89-10.42-9.89-17.99c0-11.77,9.54-21.31,21.31-21.31c3.56,0,6.92,0.87,9.87,2.42l6.61-11.44 c-5.04-1.85-10.35-2.85-15.83-2.85c-9.61,0-18.71,3.06-26.76,8.48c-8.18,5.51-15.29,13.45-20.8,23.11 c5.5,9.66,12.62,17.6,20.8,23.1C37.76,72.55,41,74.28,44.36,75.63L44.36,75.63z M63.93,41.74l6.73-11.66 c-1.82-0.95-3.77-1.64-5.79-2.03c-1.45,2.18-2.31,4.82-2.31,7.67C62.56,37.88,63.06,39.93,63.93,41.74L63.93,41.74L63.93,41.74z"/>
        </svg>
    </span>
                    </div>
                    <!-- Trường nhập lại mật khẩu để xác nhận -->
                    <div class="position-relative">
                        <input
                                class="form-control"
                                type="password"
                                id="confirmPassword"
                                placeholder="Xác nhận mật khẩu mới"
                                required
                                data-bs-toggle="tooltip"
                                data-bs-placement="top">
                        <span class="position-absolute top-50 end-0 translate-middle-y pe-3"
                              id="toggle-confirm-password"
                              onclick="toggleConfirmPassword()">
        <svg id="confirm-eye-icon" class="eye-icon" viewBox="0 0 122.88 96.32">
            <path d="M104.54,23.28c6.82,6.28,12.8,14.02,17.67,22.87l0.67,1.22l-0.67,1.21c-6.88,12.49-15.96,22.77-26.48,29.86 c-8.84,5.95-18.69,9.67-29.15,10.59l6.73-11.66c5.25-1.42,10.24-3.76,14.89-6.9c8.18-5.51,15.29-13.45,20.79-23.1 c-2.98-5.22-6.43-9.94-10.26-14.05L104.54,23.28L104.54,23.28z M88.02,0l17.84,10.3L56.2,96.32l-17.83-10.3l0.69-1.2 c-4.13-1.69-8.11-3.83-11.9-6.38C16.62,71.35,7.55,61.07,0.67,48.59L0,47.37l0.67-1.22C7.55,33.67,16.62,23.39,27.15,16.3 C37.42,9.38,49.08,5.48,61.44,5.48c7.35,0,14.44,1.38,21.14,3.94L88.02,0L88.02,0L88.02,0z M44.36,75.63l5-8.67 c-5.94-3.78-9.89-10.42-9.89-17.99c0-11.77,9.54-21.31,21.31-21.31c3.56,0,6.92,0.87,9.87,2.42l6.61-11.44 c-5.04-1.85-10.35-2.85-15.83-2.85c-9.61,0-18.71,3.06-26.76,8.48c-8.18,5.51-15.29,13.45-20.8,23.11 c5.5,9.66,12.62,17.6,20.8,23.1C37.76,72.55,41,74.28,44.36,75.63L44.36,75.63z M63.93,41.74l6.73-11.66 c-1.82-0.95-3.77-1.64-5.79-2.03c-1.45,2.18-2.31,4.82-2.31,7.67C62.56,37.88,63.06,39.93,63.93,41.74L63.93,41.74L63.93,41.74z"/>
        </svg>
    </span>
                    </div>
                    <!--                    <small class="text-muted d-block">-->
                    <!--                        Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ viết hoa, số và ký tự đặc biệt.-->
                    <!--                    </small>-->
                    <!-- Nút Đặt Lại Mật Khẩu -->
                    <div class="d-flex justify-content-center mt-4">
                        <button id="save-password-btn" type="submit" class="btn custom-btn-primary btn-block w-100 p-2"
                        >Đặt Lại
                            Mật Khẩu
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div id="FOOTER"></div>
</div>

<script>
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));

    document.getElementById('save-password-btn').addEventListener('click', function (event) {
        const newPassword = document.getElementById('password');
        const newPasswordCheck = document.getElementById('confirmPassword');

        // Kiểm tra độ dài mật khẩu mới, có ít nhất 1 kí tự in hoa, số và kí tự đặc biệt
        const passwordRegex = /^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*])[A-Za-z\d!@#$%^&*]{8,}$/;
        let isValid = true;

        // Tạo tooltip nếu người dùng không nhập gì
        if (newPassword.value.trim() === '') {
            new bootstrap.Tooltip(newPassword, {
                title: 'Vui lòng nhập mật khẩu mới',
                placement: 'right',
                trigger: 'manual',
                customClass: 'tooltip-custom'
            }).show();
            isValid = false;
        } else if (!passwordRegex.test(newPassword.value)) {
            // Tạo tooltip nếu mật khẩu không đáp ứng yêu cầu
            new bootstrap.Tooltip(newPassword, {
                title: 'Mật khẩu phải chứa ít nhất 8 kí tự, bao gồm chữ viết hoa, số và kí tự đặc biệt',
                placement: 'right',
                trigger: 'manual',
                customClass: 'tooltip-custom'
            }).show();
            isValid = false;
        }

        // Tạo tooltip nếu ô nhập lại mật khẩu trống
        if (newPasswordCheck.value.trim() === '') {
            new bootstrap.Tooltip(newPasswordCheck, {
                title: 'Vui lòng nhập lại mật khẩu',
                placement: 'right',
                trigger: 'manual',
                customClass: 'tooltip-custom'
            }).show();
            isValid = false;
        } else if (newPassword.value !== newPasswordCheck.value) {
            // Tạo tooltip nếu mật khẩu không khớp
            new bootstrap.Tooltip(newPasswordCheck, {
                title: 'Mật khẩu nhập lại không khớp với mật khẩu mới',
                placement: 'right',
                trigger: 'manual',
                customClass: 'tooltip-custom'
            }).show();
            isValid = false;
        }

        if (!isValid) {
            event.preventDefault(); // Ngăn không cho gửi form nếu không hợp lệ
        } else {
            // Ẩn các tooltip khi hợp lệ
            bootstrap.Tooltip.getInstance(newPassword)?.hide();
            bootstrap.Tooltip.getInstance(newPasswordCheck)?.hide();

            // Hiển thị modal thành công
            const successModal = new bootstrap.Modal(document.getElementById('passwordChangeSuccessModal'));
            successModal.show();
        }

        // Ẩn tooltip khi người dùng bắt đầu chỉnh sửa lại
        newPassword.addEventListener('input', () => bootstrap.Tooltip.getInstance(newPassword)?.hide());
        newPasswordCheck.addEventListener('input', () => bootstrap.Tooltip.getInstance(newPasswordCheck)?.hide());
    });

    let isPasswordVisible = false; // Biến để theo dõi hiển thị của trường mật khẩu
    let isConfirmPasswordVisible = false;

    function togglePassword() {
        const passwordInput = document.getElementById("password");
        const eyeIcon = document.getElementById("eye-icon");

        isPasswordVisible = !isPasswordVisible;
        passwordInput.type = isPasswordVisible ? "text" : "password";
        eyeIcon.innerHTML = isPasswordVisible

            ? `
<path d="M95.73,10.81c10.53,7.09,19.6,17.37,26.48,29.86l0.67,1.22l-0.67,1.21c-6.88,12.49-15.96,22.77-26.48,29.86 C85.46,79.88,73.8,83.78,61.44,83.78c-12.36,0-24.02-3.9-34.28-10.81C16.62,65.87,7.55,55.59,0.67,43.1L0,41.89l0.67-1.22 c6.88-12.49,15.95-22.77,26.48-29.86C37.42,3.9,49.08,0,61.44,0C73.8,0,85.45,3.9,95.73,10.81L95.73,10.81z M60.79,22.17l4.08,0.39 c-1.45,2.18-2.31,4.82-2.31,7.67c0,7.48,5.86,13.54,13.1,13.54c2.32,0,4.5-0.62,6.39-1.72c0.03,0.47,0.05,0.94,0.05,1.42 c0,11.77-9.54,21.31-21.31,21.31c-11.77,0-21.31-9.54-21.31-21.31C39.48,31.71,49.02,22.17,60.79,22.17L60.79,22.17L60.79,22.17z M109,41.89c-5.5-9.66-12.61-17.6-20.79-23.11c-8.05-5.42-17.15-8.48-26.77-8.48c-9.61,0-18.71,3.06-26.76,8.48 c-8.18,5.51-15.29,13.45-20.8,23.11c5.5,9.66,12.62,17.6,20.8,23.1c8.05,5.42,17.15,8.48,26.76,8.48c9.62,0,18.71-3.06,26.77-8.48 C96.39,59.49,103.5,51.55,109,41.89L109,41.89z"/>
`
            : `
<path d="M104.54,23.28c6.82,6.28,12.8,14.02,17.67,22.87l0.67,1.22l-0.67,1.21c-6.88,12.49-15.96,22.77-26.48,29.86 c-8.84,5.95-18.69,9.67-29.15,10.59l6.73-11.66c5.25-1.42,10.24-3.76,14.89-6.9c8.18-5.51,15.29-13.45,20.79-23.1 c-2.98-5.22-6.43-9.94-10.26-14.05L104.54,23.28L104.54,23.28z M88.02,0l17.84,10.3L56.2,96.32l-17.83-10.3l0.69-1.2 c-4.13-1.69-8.11-3.83-11.9-6.38C16.62,71.35,7.55,61.07,0.67,48.59L0,47.37l0.67-1.22C7.55,33.67,16.62,23.39,27.15,16.3 C37.42,9.38,49.08,5.48,61.44,5.48c7.35,0,14.44,1.38,21.14,3.94L88.02,0L88.02,0L88.02,0z M44.36,75.63l5-8.67 c-5.94-3.78-9.89-10.42-9.89-17.99c0-11.77,9.54-21.31,21.31-21.31c3.56,0,6.92,0.87,9.87,2.42l6.61-11.44 c-5.04-1.85-10.35-2.85-15.83-2.85c-9.61,0-18.71,3.06-26.76,8.48c-8.18,5.51-15.29,13.45-20.8,23.11 c5.5,9.66,12.62,17.6,20.8,23.1C37.76,72.55,41,74.28,44.36,75.63L44.36,75.63z M63.93,41.74l6.73-11.66 c-1.82-0.95-3.77-1.64-5.79-2.03c-1.45,2.18-2.31,4.82-2.31,7.67C62.56,37.88,63.06,39.93,63.93,41.74L63.93,41.74L63.93,41.74z"/>
`;
    }

    function toggleConfirmPassword() {
        const confirmPasswordInput = document.getElementById("confirmPassword");
        const confirmEyeIcon = document.getElementById("confirm-eye-icon");

        isConfirmPasswordVisible = !isConfirmPasswordVisible;
        confirmPasswordInput.type = isConfirmPasswordVisible ? "text" : "password";

        confirmEyeIcon.innerHTML = isConfirmPasswordVisible
            ? `
                <path d="M95.73,10.81c10.53,7.09,19.6,17.37,26.48,29.86l0.67,1.22l-0.67,1.21c-6.88,12.49-15.96,22.77-26.48,29.86 C85.46,79.88,73.8,83.78,61.44,83.78c-12.36,0-24.02-3.9-34.28-10.81C16.62,65.87,7.55,55.59,0.67,43.1L0,41.89l0.67-1.22 c6.88-12.49,15.95-22.77,26.48-29.86C37.42,3.9,49.08,0,61.44,0C73.8,0,85.45,3.9,95.73,10.81L95.73,10.81z M60.79,22.17l4.08,0.39 c-1.45,2.18-2.31,4.82-2.31,7.67c0,7.48,5.86,13.54,13.1,13.54c2.32,0,4.5-0.62,6.39-1.72c0.03,0.47,0.05,0.94,0.05,1.42 c0,11.77-9.54,21.31-21.31,21.31c-11.77,0-21.31-9.54-21.31-21.31C39.48,31.71,49.02,22.17,60.79,22.17L60.79,22.17L60.79,22.17z M109,41.89c-5.5-9.66-12.61-17.6-20.79-23.11c-8.05-5.42-17.15-8.48-26.77-8.48c-9.61,0-18.71,3.06-26.76,8.48 c-8.18,5.51-15.29,13.45-20.8,23.11c5.5,9.66,12.62,17.6,20.8,23.1c8.05,5.42,17.15,8.48,26.76,8.48c9.62,0,18.71-3.06,26.77-8.48 C96.39,59.49,103.5,51.55,109,41.89L109,41.89z"/>`
            : `
                <path d="M104.54,23.28c6.82,6.28,12.8,14.02,17.67,22.87l0.67,1.22l-0.67,1.21c-6.88,12.49-15.96,22.77-26.48,29.86 c-8.84,5.95-18.69,9.67-29.15,10.59l6.73-11.66c5.25-1.42,10.24-3.76,14.89-6.9c8.18-5.51,15.29-13.45,20.79-23.1 c-2.98-5.22-6.43-9.94-10.26-14.05L104.54,23.28L104.54,23.28z M88.02,0l17.84,10.3L56.2,96.32l-17.83-10.3l0.69-1.2 c-4.13-1.69-8.11-3.83-11.9-6.38C16.62,71.35,7.55,61.07,0.67,48.59L0,47.37l0.67-1.22C7.55,33.67,16.62,23.39,27.15,16.3 C37.42,9.38,49.08,5.48,61.44,5.48c7.35,0,14.44,1.38,21.14,3.94L88.02,0L88.02,0L88.02,0z M44.36,75.63l5-8.67 c-5.94-3.78-9.89-10.42-9.89-17.99c0-11.77,9.54-21.31,21.31-21.31c3.56,0,6.92,0.87,9.87,2.42l6.61-11.44 c-5.04-1.85-10.35-2.85-15.83-2.85c-9.61,0-18.71,3.06-26.76,8.48c-8.18,5.51-15.29,13.45-20.8,23.11 c5.5,9.66,12.62,17.6,20.8,23.1C37.76,72.55,41,74.28,44.36,75.63L44.36,75.63z M63.93,41.74l6.73-11.66 c-1.82-0.95-3.77-1.64-5.79-2.03c-1.45,2.18-2.31,4.82-2.31,7.67C62.56,37.88,63.06,39.93,63.93,41.74L63.93,41.74L63.93,41.74z"/>`;

    }


</script>

</body>
</html>
